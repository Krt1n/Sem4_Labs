ITA44@CSEORCL
ITA44


1. Find courses that ran in Fall 2009 or in Spring 2010 INTERSECT (Use intersect 
all to retain duplicates):
SELECT course_id FROM section where semester='Fall' and year=2009 UNION ALL SELECT course_id FROM section where semester='Spring' and year=2010;

COURSE_I
--------
CS-101
CS-347
PHY-101
CS-101
CS-315
CS-319
CS-319
FIN-201
HIS-351
MU-199

2. Find courses that ran in Fall 2009 and in spring 2010  

SELECT course_id FROM section where semester='Fall' and year=2009 INTERSECT SELECT course_id FROM section where semester='Spring' and year=2010;

COURSE_I
--------
CS-101

3. Find courses that ran in Fall 2009 but not in Spring 2010
SELECT course_id FROM section where semester='Fall' and year=2009 MINUS SELECT course_id FROM section where semester='Spring' and year=2010;

COURSE_I
--------
CS-347
PHY-101

4. Find the name of the course for which none of the students registered. 

SELECT course_id, title
FROM course
MINUS
SELECT c.course_id, c.title
FROM course c, takes t
WHERE c.course_id = t.course_id;

COURSE_I TITLE
-------- --------------------------------------------------
BIO-399  Computational Biology

5. Find courses offered in Fall 2009 and in Spring 2010. 

SELECT DISTINCT course_id FROM section where semester='Fall' AND year=2009 AND course_id IN(SELECT course_id FROM section where semester='Spring' and year=2010);

COURSE_I
--------
CS-101

6.Find the total number of students who have taken course taught by the instructor with ID 10101.
SELEC


7. Find courses offered in Fall 2009 but not in Spring 2010.  
SELECT DISTINCT course_id FROM section where semester='Fall' AND year=2009 AND course_id NOT IN(SELECT course_id FROM section where semester='Spring' and year=2010);

COURSE_I
--------
CS-347
PHY-101

8. Find the names of all students whose name is same as the instructorâ€™s name.  

SELECT s.name FROM Student s where s.name IN (SELECT i.name FROM Instructor i);

NAME
--------------------
Brandt

9. Find names of instructors with salary greater than that of some instructor in biology department.

SELECT name FROM instructor where salary > SOME (SELECT salary FROM instructor where dept_name='Biology');

NAME
--------------------
Einstein
Brandt
Wu
Gold
Kim
Singh
Katz

10. Find the names of all instructors whose salary is greater than the salary of all 
instructors in the Biology department.  

SQL> SELECT name FROM instructor where salary > ALL (SELECT salary FROM instructor where dept_name='Biology');

NAME
--------------------
Katz
Singh
Kim
Gold
Wu
Brandt
Einstein

11. Find the departments that have the highest average salary.
 
SELECT dept_name
FROM instructor
GROUP BY dept_name
HAVING AVG(salary) >= ALL (
    SELECT AVG(salary)
    FROM instructor
    GROUP BY dept_name
);

DEPT_NAME
--------------------
Physics

12. Find the names of those departments whose budget is lesser than the average salary of all instructors.

SELECT dept_name FROM department where budget < (SELECT avg(salary) from instructor);

DEPT_NAME
--------------------
History
Physics

13. Find all courses taught in both the Fall 2009 semester and in the Spring 2010 
semester.  

SELECT DISTINCT s.course_id
FROM section s
WHERE s.semester = 'Fall' AND s.year = 2009
  AND EXISTS (
      SELECT 1
      FROM section s2
      WHERE s2.course_id = s.course_id
        AND s2.semester = 'Spring'
        AND s2.year = 2010);

14. Find all students who have taken all courses offered in the Biology department.  

SELECT DISTINCT s.ID
FROM student s
WHERE NOT EXISTS (
    SELECT c.course_id
    FROM course c
    WHERE c.dept_name = 'Biology'
      AND NOT EXISTS (
          SELECT 1
          FROM takes t
          WHERE t.ID = s.ID
            AND t.course_id = c.course_id
      )
);


15. Find all courses that were offered at most once in 2009.  

SELECT DISTINCT s.course_id
FROM section s
WHERE s.year = 2009
  AND NOT EXISTS (
      SELECT 1
      FROM section s2
      WHERE s2.course_id = s.course_id
        AND s2.year = 2009
        AND s2.sec_id <> s.sec_id
  );


16.Find all the students who have opted at least two courses offered by CSE department.
 
SELECT t.ID
FROM Takes t
JOIN Course c ON t.course_id = c.course_id
WHERE c.dept_name = 'Comp. Sci.'
GROUP BY t.ID
HAVING COUNT(DISTINCT t.course_id) >= 2;


17.Find the average instructors salary of those departments where the average salary is greater than 42000

SELECT dept_name, avg_salary
FROM (
    SELECT dept_name, AVG(salary) AS avg_salary
    FROM instructor
    GROUP BY dept_name
) AS dept_avg WHERE dept_avg.avg_salary > 42000;

18. Create a view all_courses consisting of course sections offered by Physics department in the Fall 2009, with the building and room number of each section.  

CREATE VIEW all_courses AS
SELECT s.course_id,
       s.sec_id,
       s.semester,
       s.year,
       s.building,
       s.room_number
FROM section s, course c
WHERE s.course_id = c.course_id
  AND c.dept_name = 'Physics'
  AND s.semester = 'Fall'
  AND s.year = 2009;

19. Select all the courses from all_courses view.  
SELECT * FROM all_courses;

COURSE_I SEC_ID   SEMEST       YEAR BUILDING        ROOM_NU
-------- -------- ------ ---------- --------------- -------
PHY-101  1        Fall         2009 Watson          100

20. Create a view department_total_salary consisting of department name and total 
salary of that department. 

CREATE VIEW department_total_salary AS
SELECT dept_name,
       SUM(salary) AS total_salary
FROM instructor
GROUP BY dept_name;

DEPT_NAME            TOTAL_SALARY
-------------------- ------------
Elec. Eng.                  80000
Physics                    182000
Comp. Sci.                 232000
Finance                    170000
Biology                     72000
Music                       40000
History                    122000







